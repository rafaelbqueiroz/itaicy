### üí° Quick diagnosis (PM + UX + UI eyes)

| Pain point                                               | Why it hurts Itaicy today                                                               | Impact                                                               |
| -------------------------------------------------------- | --------------------------------------------------------------------------------------- | -------------------------------------------------------------------- |
| 1. **Conte√∫do atomizado em abas** (Blocos, Su√≠tes, SEO‚Ä¶) | O usu√°rio precisa ‚Äúca√ßar‚Äù onde editar cada peda√ßo; falta vis√£o hol√≠stica de uma p√°gina. | Erros de copy, demora para atualizar, baixa ado√ß√£o.                  |
| 2. **Sem media-library**                                 | Imagens / v√≠deos exigem URL manual ‚Äì ningu√©m quer subir arquivos via FTP.               | Fric√ß√£o enorme, risco de 404, perda de performance (sem otimiza√ß√£o). |
| 3. **Blog ausente**                                      | Itaicy perde canal de aquisi√ß√£o org√¢nica e storytelling.                                | Tr√°fego org√¢nico menor, depend√™ncia de Ads.                          |
| 4. **SEO fora do contexto da p√°gina**                    | Campos gen√©ricos; n√£o herdam slug, OG image, etc.                                       | Metadados inconsistentes ‚Üí rank pior.                                |
| 5. **Preview inexistente / publish workflow raso**       | N√£o h√° status Draft ‚Üí Review ‚Üí Published, nem pr√©-visualiza√ß√£o.                         | Medo de editar conte√∫do em produ√ß√£o.                                 |
| 6. **UI linear, sem hierarquia**                         | Listas longas, bot√µes pequenos, falta barra lateral.                                    | Faz o usu√°rio ‚Äúrolar e procurar‚Äù ‚Äì baixa efici√™ncia.                 |

---

## üéØ Produto alvo: ‚ÄúItaicy CMS 1.0‚Äù

> **Vis√£o**: *Painel √∫nico, drag-and-drop, com library de m√≠dia, blog e SEO em contexto, totalmente hospedado no Supabase + React-admin UI*.

### Epics & entreg√°veis chave

| Epic                    | Resultado demarc√°vel                                                                                                                          | M√©trica de sucesso                                           |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| **E1 Media Library**    | Upload arrastar-soltar (imagens, v√≠deos, PDF), thumbnails autom√°ticas, CDN urls copy-safe                                                     | 95 % das p√°ginas usam assets do bucket, zero links quebrados |
| **E2 Page Builder 2.0** | Sidebar ‚ÄúSite Map‚Äù; ao clicar em p√°gina, mostra blocos empilhados ‚Üí arraste para reordenar, ‚Äú+‚Äù para inserir componente (Hero, Gallery, FAQ‚Ä¶) | Atualizar Hero leva < 30 s em teste de usu√°rio               |
| **E3 SEO in-context**   | Aba ‚ÄúSEO‚Äù dentro do modal da p√°gina/bloco (title, description, OG image preview) + valida√ß√£o de length                                        | Todos os slugs publicados t√™m meta description > 120 char    |
| **E4 Blog Module**      | Editor Markdown/TipTap com upload inline, tags, thumb, preview; rota `/blog/[slug]` gerada                                                    | 2 artigos publicados em primeira semana                      |
| **E5 Workflow & Roles** | Status Draft ‚Üí Review ‚Üí Published; RLS: admin / editor; bot√£o Preview com token expira                                                        | 100 % das edi√ß√µes passam por review em staging               |
| **E6 UI/UX Polishing**  | Sidebar persistente, comando ‚Äú/‚Äù para busca r√°pida, dark/light theme; bot√µes primary ‚âà Design System                                          | SUS (System-Usability-Scale) ‚â• 80 com equipe Itaicy          |

---

## üóÇÔ∏è Backlog detalhado (MoSCoW + estimativa)

| #                    | Item                                                                                                 | Must / Should / Could | Est. |
| -------------------- | ---------------------------------------------------------------------------------------------------- | --------------------- | ---- |
| **Media Library**    |                                                                                                      |                       |      |
| M1                   | Tabela `media` (id, filename, alt, width, height, blurhash, folder, created\_by)                     | **M**                 | 3    |
| M2                   | Bucket Supabase `public-media`; RLS read=anon, write=role\:editor                                    | **M**                 | 2    |
| M3                   | Modal ‚ÄúAdicionar m√≠dia‚Äù (drag-upload, progress bar, duplicate slug guard)                            | **M**                 | 5    |
| M4                   | Transform endpoints (`?w=`, AVIF, WebP) + `next/image` loader util                                   | **S**                 | 3    |
| **Page Builder**     |                                                                                                      |                       |      |
| P1                   | Sidebar √°rvore de p√°ginas (CRUD) + re-order via `position` column                                    | **M**                 | 5    |
| P2                   | Componente BlockList: render cards (type, title) > drag reorder > modal edit                         | **M**                 | 8    |
| P3                   | Nova cole√ß√£o `block_types` (Hero, Stats, ExperiencesGrid‚Ä¶) schema & UI forms dynamic via JSON schema | **M**                 | 8    |
| P4                   | Permitir ‚ÄúDuplicate block‚Äù, ‚ÄúDisable block‚Äù toggle                                                   | **C**                 | 3    |
| **SEO**              |                                                                                                      |                       |      |
| S1                   | Campo SEO dentro do modal de p√°gina (title, description, canonical, OG image from media)             | **M**                 | 3    |
| S2                   | Gancho que gera `sitemap.xml` e `robots.txt` automaticamente (Edge Function)                         | **S**                 | 5    |
| **Blog**             |                                                                                                      |                       |      |
| B1                   | Tabela `posts` (id, title, slug, excerpt, body\_md, cover\_id, tags\[], status)                      | **M**                 | 3    |
| B2                   | TipTap editor + upload inline (usa Media Library)                                                    | **M**                 | 8    |
| B3                   | Listagem / filtros / search, preview draft token                                                     | **S**                 | 5    |
| **Workflow & Roles** |                                                                                                      |                       |      |
| W1                   | Enum `status` em pages, posts, blocks (draft/review/published)                                       | **M**                 | 2    |
| W2                   | Trigger: on status change to published ‚Üí revalidate route                                            | **M**                 | 3    |
| W3                   | Roles table + policy templates (admin, editor, viewer) + audit\_log                                  | **S**                 | 5    |
| **UI Polish**        |                                                                                                      |                       |      |
| U1                   | Implement `react-admin` theme with Itaicy tokens, responsive drawer                                  | **M**                 | 5    |
| U2                   | Command Palette ‚Äú‚åòK‚Äù global search (pages, media)                                                    | **C**                 | 3    |
| U3                   | Dark mode toggle (prefers-color-scheme)                                                              | **C**                 | 2    |

*Estimativa em pontos (‚âà0.5 day/point).*

---

## üîÑ Road-map sugerido (6 semanas)

| Sprint                 | Foco                   | Principais hist√≥rias                    | Meta de demo                                          |
| ---------------------- | ---------------------- | --------------------------------------- | ----------------------------------------------------- |
| **S1** (sem 1‚Äì2)       | **Funda√ß√£o DB + Auth** | M1-M2, W1                               | Upload imagem aparece em tabela, status draft vis√≠vel |
| **S2** (sem 3)         | **Media Library UI**   | M3-M4                                   | Equipe faz upload, pega URL otimizada                 |
| **S3** (sem 4)         | **Page Builder core**  | P1-P2, S1                               | Consegue editar Hero da Home e ver em preview         |
| **S4** (sem 5)         | **Blog MVP + SEO**     | B1-B3, S2                               | Novo post publicado, sitemap atualizado               |
| **S5** (sem 6)         | **Workflow & Polish**  | W2-W3, U1                               | Editor cria page, reviewer publica; drawer responsivo |
| **Hardening / buffer** | QA, docs, training     | U2-U3, manual do usu√°rio em Loom v√≠deos | Zero blocker para hand-off                            |

---

## üõ†Ô∏è Stack & libs recomendadas

* **UI Lib**: `react-admin 4` + `@tanstack/react-table` + `UploadThing` for drag upload
* **Rich-text**: `Tiptap` (Markdown + slash-commands)
* **Images**: Supabase Storage + imgproxy CDN
* **Validation**: `zod` + JSON-Schema forms
* **Preview**: signed JWT ‚Üí `/api/preview?token=‚Ä¶` sets draft cookie
* **Revalidation**: Next.js `revalidateTag` or Remix `headers.revalidate`

---

## ‚úÖ Checklist para entrega final

1. [ ] Conectar Storage & generate blurhash on upload
2. [ ] Migrar conte√∫dos atuais para novas tabelas
3. [ ] Criar roles e pol√≠ticas RLS (documentadas)
4. [ ] Manual ‚ÄúComo publicar‚Äù (PDF + Loom) entregue a equipe
5. [ ] Monitoramento: Supabase logs + Sentry front/back
6. [ ] Usability test com 2 usu√°rios Itaicy ‚Äì SUS ‚â• 80

---

### Conclus√£o

Ao transformar o editor de ‚Äúblocos dispersos‚Äù em **Page Builder modular + Library √∫nica**, adicionando workflow, media e blog, o Itaicy CMS deixa de ser um painel t√©cnico e passa a ser *produto editorial* que **qualquer membro da pousada** usa em minutos ‚Äì sem abrir VS Code nem pedir ajuda.
